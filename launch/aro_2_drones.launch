<?xml version="1.0"?>

<launch>

    <arg name="model" default="$(find hector_quadrotor_description)/urdf/quadrotor.gazebo.xacro" />
    <arg name="world" default="my_generated" doc="launch specific or generated world"/>
    <arg name="rviz" default="false" doc="enable ('true') or disable rviz"/>

    <!-- start generated world -->
    <group if="$(eval arg('world') == 'generated')">
        <include file="$(find hector_gazebo_worlds)/launch/start.launch">
            <arg name="world" value="$(find virtual_maize_field)/worlds/generated.world"/>
        </include>
    </group>

    <!-- start changed generated world -->
    <group if="$(eval arg('world') == 'my_generated')">
        <include file="$(find hector_gazebo_worlds)/launch/start.launch">
            <arg name="world" value="$(find aro)/worlds/generated_moved.world"/>
        </include>
    </group>

    <!-- start test world -->
    <group if="$(eval arg('world') == 'test')">
        <include file="$(find hector_gazebo_worlds)/launch/start.launch">
            <arg name="world" value="$(find aro)/worlds/aro_field_world_v2.world"/>
        </include>
    </group>

    <group ns="uav1">
        <!-- spawn uav1 -->
        <include file="$(find hector_quadrotor_gazebo)/launch/spawn_quadrotor.launch">
            <arg name="name" value="uav1" />
            <arg name="tf_prefix" value="uav1" />
            <arg name="model" value="$(arg model)" />
            <arg name="x" value="8" />
            <arg name="y" value="4.0" />
            <arg name="z" value="1.4" />
        </include>
        <!-- start uav1/hector_node-->
        <node pkg="aro" type="hector_node.py" name="hector_node" output="screen" args="1">
            <rosparam command="load" file="$(find aro)/config/simulation.yaml" />
            <remap from="/release" to="/uav1/release"/>
            <remap from="/ground_truth/state" to="/uav1/ground_truth/state"/>
            <remap from="/sonar_height" to="/uav1/sonar_height"/>
            <remap from="/cmd_vel" to="/uav1/cmd_vel"/>
        </node>
    </group>

    <group ns="uav2">
        <!-- spawn uav2 -->
        <include file="$(find hector_quadrotor_gazebo)/launch/spawn_quadrotor.launch">
            <arg name="name" value="uav2" />
            <arg name="tf_prefix" value="uav2" />
            <arg name="model" value="$(arg model)" />
            <arg name="x" value="8" />
            <arg name="y" value="6" />
            <arg name="z" value="1.4" />
        </include>
        <!-- start uav2/hector_node-->
        <node pkg="aro" type="hector_node.py" name="uav2_hector_node" output="screen" args="2">
            <rosparam command="load" file="$(find aro)/config/simulation.yaml" />
            <remap from="/release" to="/uav2/release"/>
            <remap from="/ground_truth/state" to="/uav2/ground_truth/state"/>
            <remap from="/sonar_height" to="/uav2/sonar_height"/>
            <remap from="/cmd_vel" to="/uav2/cmd_vel"/>
        </node>
    </group>

    <!-- start rviz visualization with sonar config -->
    <group if="$(arg rviz)">
        <node pkg="rviz" type="rviz" name="rviz" args="-d $(find aro)/config/aro_sonar.rviz"/>
    </group>

</launch>